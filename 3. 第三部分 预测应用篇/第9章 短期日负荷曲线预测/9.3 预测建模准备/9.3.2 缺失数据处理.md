```python
import missingno as msno
import pandas as pd
data = pd.read_csv("energy_out.csv")
msno.matrix(data, labels=True,figsize=(45,10))
```

```python
import datetime
import numpy as np
weth = pd.read_csv("weather.csv")
# 获取星期数据
data['weekday']=[datetime.datetime.strptime(x,'%Y/%m/%d').weekday() for x in data.LOAD_DATE]
# 获取月份数据
data['month']=[datetime.datetime.strptime(x,'%Y/%m/%d').month for x in data.LOAD_DATE]
data['date']=[datetime.datetime.strptime(x,'%Y/%m/%d') for x in data.LOAD_DATE]
# 将数据按日期升序排列
data = data.sort_values(by='date')
# 获取时间趋势数据
data['trend'] = range(data.shape[0])
# 设置索引并按索引进行关联
data=data.set_index('LOAD_DATE')
weth=weth.set_index('WETH_DATE')
p = data.join(weth)
p = p.drop(columns='date')
# 声明列表用于存储位置及插补值信息
out = list()
for index in np.where(p.apply(lambda x:np.sum(np.isnan(x)),axis=1)>0)[0]:
    selcol = np.logical_not(np.isnan(p.iloc[index]))
    usecol = np.where(selcol)[0]
    cols = np.where(~selcol)[0]
    for col in cols:
        nbs = np.where(p.iloc[:,usecol].apply(lambda x:np.sum(np.isnan(x)),axis=1)==0)[0]
        nbs = nbs[nbs != index]
        nbs = (list(set(nbs).intersection(set(np.where(np.logical_not(np.isnan(p.iloc[:,col])))[0]))))
        t0 = [np.sqrt(np.sum((p.iloc[index,usecol]-p.iloc[x,usecol])**2)) for x in nbs]
        t1 = 1/np.array(t0)
        t_wts = t1/np.sum(t1)
        out.append((index,col,np.sum(p.iloc[nbs,col].values*t_wts)))
```

```python
out
# [(18, 0, 15.862533989395969),
#  (18, 1, 15.066161287502018),
#  (18, 2, 14.19980745932543),
#  (18, 3, 13.58345782262413),
#  (18, 4, 13.51538093937498),
#  ...
```

```python
for v in out:
    p.iloc[v[0],v[1]]=v[2]
    
p.head()
```

```python
msno.matrix(p, labels=True,figsize=(45,10))
```