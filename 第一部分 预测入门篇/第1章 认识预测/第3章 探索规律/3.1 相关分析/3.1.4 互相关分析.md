```python
import scipy.signal as sg

def ccf(x, y, lag_max = 100):
    result = sg.correlate(y - np.mean(y), x - np.mean(x), method='direct') / (np.std(y) * np.std(x) * len(x))
    length = int((len(result) - 1) / 2)
    low = length - lag_max
    high = length + (lag_max + 1)
    return result[low:high]
```

```python
import pandas as pd

airmiles = pd.read_csv("airmiles.csv")
lakehuron = pd.read_csv("LakeHuron.csv")
lhdata = lakehuron.query("1937 <= year <= 1960")
x,y = airmiles.miles,lhdata.level

out=ccf(x,y)
for i in range(len(out)):
    plt.plot([i,i],[0,out[i]],'k-')
    plt.plot(i,out[i],'ko')
plt.xlabel("lag",fontsize=14)
plt.xticks(range(21),range(-10,11,1))
plt.ylabel("ccf",fontsize=14)
plt.show()
```