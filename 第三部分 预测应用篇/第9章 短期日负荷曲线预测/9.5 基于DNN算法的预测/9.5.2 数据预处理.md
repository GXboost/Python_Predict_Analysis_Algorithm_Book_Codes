```python
import matplotlib.pyplot as plt
import pandas as pd
import numpy as np
import keras

data = p
parts = 14
this_one = data.iloc[parts:]
bak_index = this_one.index
for k in range(1, parts + 1):
    last_one = data.iloc[(parts - k):(this_one.shape[0] - k + parts)]
    this_one.set_index(last_one.index, drop=True, inplace=True)
    this_one = this_one.join(last_one, lsuffix="", rsuffix="_p" + str(k))

this_one.set_index(bak_index, drop=True, inplace=True)
this_one = this_one.fillna(0)
t0 = this_one.iloc[:, 0:96]
t0_min = t0.apply(lambda x: np.min(x), axis=0).values
t0_ptp = t0.apply(lambda x: np.ptp(x), axis=0).values
this_one = this_one.apply(lambda x: (x - np.min(x)) / np.ptp(x), axis=0)
```

```python
test_data = this_one.iloc[-30:]
train_data = this_one.iloc[:-30]
train_y_df = train_data.iloc[:, 0:96]
train_y = np.array(train_y_df)
train_x_df = train_data.iloc[:, 96:]
train_x = np.array(train_x_df)

test_y_df = test_data.iloc[:, 0:96]
test_y = np.array(test_y_df)
test_x_df = test_data.iloc[:, 96:]
test_x = np.array(test_x_df)
test_y_real = t0.iloc[-30:]
```