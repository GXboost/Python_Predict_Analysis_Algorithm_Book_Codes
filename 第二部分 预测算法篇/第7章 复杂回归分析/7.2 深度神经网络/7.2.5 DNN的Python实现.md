```python
import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
import keras

# 准备基础数据
iris = pd.read_csv("iris.csv")
x,y = iris.drop(columns=['Species','Petal.Width']),iris['Petal.Width']

# 标准化处理
x = x.apply(lambda v:(v-np.mean(v))/np.std(v))
x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.33, random_state=1)
```

```python
# 定义模型
init = keras.initializers.glorot_uniform(seed=1)
simple_adam = keras.optimizers.Adam(lr=0.0001)
model = keras.models.Sequential()
model.add(keras.layers.Dense(units=8, input_dim=3, kernel_initializer=init, activation='relu'))
model.add(keras.layers.Dense(units=16, kernel_initializer=init, activation='relu'))
model.add(keras.layers.Dense(units=8, kernel_initializer=init, activation='relu'))
model.add(keras.layers.Dense(units=4, kernel_initializer=init, activation='relu'))
model.add(keras.layers.Dense(units=1, kernel_initializer=init, activation='relu'))
model.compile(loss='mean_squared_error', optimizer=simple_adam)
```

```python
# 训练模型
b_size = 2
max_epochs = 100
print("Starting training ")
h = model.fit(x_train, y_train, batch_size=b_size, epochs=max_epochs, shuffle=True, verbose=1)
print("Training finished \n")

# Starting training 
# Epoch 1/100
# 100/100 [==============================] - 2s 20ms/step - loss: 2.0479
# ......
# Epoch 99/100
# 100/100 [==============================] - 0s 1ms/step - loss: 0.0429
# Epoch 100/100
# 100/100 [==============================] - 0s 1ms/step - loss: 0.0428
# Training finished 
```

```python
# 评估模型
out = model.evaluate(x_test, y_test, verbose=0)
print("Evaluation on test data: loss = %0.6f \n" % (out*len(y_test)))
# Evaluation on test data: loss = 1.869615 
```